<!DOCTYPE html>
    <html lang="zh_CN" data-theme-mode="light" data-light-theme="daylight" data-dark-theme="midnight">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="stylesheet" type="text/css" id="baseStyle" href="../../../stage/build/export/base.css?2.10.2"/>
        <link rel="stylesheet" type="text/css" id="themeDefaultStyle" href="../../../appearance/themes/daylight/theme.css?2.10.2"/>

        <title>数据同步</title>
        <style>
            body {background-color: var(--b3-theme-background);color: var(--b3-theme-on-background)}
            .b3-typography, .protyle-wysiwyg, .protyle-title {font-size:16px !important}
            .b3-typography code:not(.hljs), .protyle-wysiwyg span[data-type~=code] { font-variant-ligatures: none }
            .li > .protyle-action {height:34px;line-height: 34px}
            .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h1, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h2, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h3, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h4, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h5, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h6 {line-height:34px;}
            .protyle-wysiwyg [data-node-id].li > .protyle-action:after {height: 16px;width: 16px;margin:-8px 0 0 -8px}
            .protyle-wysiwyg [data-node-id].li > .protyle-action svg {height: 14px}
            .protyle-wysiwyg [data-node-id].li:before {height: calc(100% - 34px);top:34px}
            .protyle-wysiwyg [data-node-id] [spellcheck] {min-height:26px;}
            .protyle-wysiwyg [data-node-id] {}
            .protyle-wysiwyg .li {min-height:34px}
            .protyle-gutters button svg {height:26px}
            .protyle-wysiwyg img.emoji, .b3-typography img.emoji {width:18px}
            .protyle-wysiwyg .h1 img.emoji, .b3-typography h1 img.emoji {width:35px}
            .protyle-wysiwyg .h2 img.emoji, .b3-typography h2 img.emoji {width:31px}
            .protyle-wysiwyg .h3 img.emoji, .b3-typography h3 img.emoji {width:27px}
            .protyle-wysiwyg .h4 img.emoji, .b3-typography h4 img.emoji {width:25px}
            .protyle-wysiwyg .h5 img.emoji, .b3-typography h5 img.emoji {width:22px}
            .protyle-wysiwyg .h6 img.emoji, .b3-typography h6 img.emoji {width:20px}
        </style>
    </head>
    <body>
    <div class="protyle-wysiwyg protyle-wysiwyg--attr" style="max-width: 800px;margin: 0 auto;" id="preview">

    <div data-subtype="h2" data-node-id="20230808120347-wx5cr4v" data-node-index="0" data-type="NodeHeading" class="h2" updated="20210721103911"><div contenteditable="true" spellcheck="false">概述</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-node-id="20230808120347-q4v034g" data-node-index="1" data-type="NodeParagraph" class="p" updated="20210721103854"><div contenteditable="true" spellcheck="false">数据同步指的是在多个设备上保持 <span data-type="code">​工作空间/data/</span>​ 文件夹数据一致，包括<span data-type="virtual-block-ref">资源文件</span>、模板、<span data-type="virtual-block-ref">挂件</span>以及笔记本数据。</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="h2" data-node-id="20230808120347-qbr56bx" data-node-index="2" data-type="NodeHeading" class="h2" updated="20210721103758"><div contenteditable="true" spellcheck="false">使用方式</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-node-id="20230808120347-2p4bc49" data-node-index="3" data-type="NodeParagraph" class="p" updated="20220821170632"><div contenteditable="true" spellcheck="false"><span data-type="block-ref" data-subtype="s" data-id="20220615113758-i2279ot">初始化数据仓库密钥</span>后如果一切正常就已经配置好同步了。如果你不太熟悉同步配置，建议通过点击同步按钮打开同步配置向导，通过向导进行配置会更简便一些。</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-n3vxtba" data-node-index="4" data-type="NodeList" class="list" updated="20220708101339"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-kmv8g3m" data-type="NodeListItem" class="li" updated="20220708101329"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-mthf707" data-type="NodeParagraph" class="p" updated="20220708101330"><div contenteditable="true" spellcheck="false">如果需要暂停同步，可关闭选项 <span data-type="kbd">​设置</span>​ - <span data-type="kbd">​云端</span>​ - <span data-type="kbd">​启用云端同步</span>​</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-2m0pkdb" data-type="NodeListItem" class="li" updated="20220708101339"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-cslq6vc" data-type="NodeParagraph" class="p" updated="20220708101339"><div contenteditable="true" spellcheck="false"><span data-type="block-ref" data-subtype="s" data-id="20210928094544-vg2c2ts">忽略文件</span></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-node-id="20230808120347-qytpdxh" data-node-index="5" data-type="NodeParagraph" class="p" updated="20220831004438"><div contenteditable="true" spellcheck="false">​<span data-type="tag">​注意</span>​​​：</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-y41kxh2" data-node-index="6" data-type="NodeList" class="list" updated="20230220103623"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-xthfmk7" data-type="NodeListItem" class="li" updated="20230220103623"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-p3dn7n3" data-type="NodeParagraph" class="p" updated="20230220103623"><div contenteditable="true" spellcheck="false">启用同步前，请确保参与同步的所有设备系统时间一致</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-3l72g5v" data-type="NodeListItem" class="li" updated="20230220103538"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-4mlag9e" data-type="NodeParagraph" class="p" updated="20230220103539"><div contenteditable="true" spellcheck="false">如果数据量较大，建议通过设置中的 <span data-type="kbd">​导出 - Data</span>​​ 导出数据包，然后将该数据包通过手动拷贝或者其他方式发送到新设备上，并在新设备上 <span data-type="kbd">​导入 - Data</span>​​，最后再配置同步</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="h2" data-node-id="20230808120347-buiv5yn" data-node-index="7" data-type="NodeHeading" class="h2" updated="20230219120246"><div contenteditable="true" spellcheck="false">同步模式</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-node-id="20230808120347-fwrmpx3" data-node-index="8" data-type="NodeParagraph" class="p" updated="20230219120420"><div contenteditable="true" spellcheck="false">在 <span data-type="kbd">​设置</span>​​ - <span data-type="kbd">​云端</span>​​ - <span data-type="kbd">​云端同步模式</span>​​ 中支持三种同步模式：</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-amosggq" data-node-index="9" data-type="NodeList" class="list" updated="20230219121049"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-7xxyobg" data-type="NodeListItem" class="li" updated="20230219121045"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-nwozegn" data-type="NodeParagraph" class="p" updated="20230219121007"><div contenteditable="true" spellcheck="false">自动同步</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-l1b7vtd" data-type="NodeList" class="list" updated="20230219121045"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-7yo5dux" data-type="NodeListItem" class="li"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-33fgevw" data-type="NodeParagraph" class="p"><div contenteditable="true" spellcheck="false">启动和退出时会进行一次同步，使用中数据不再变动后 30 秒进行一次同步</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-k9w4s4e" data-type="NodeListItem" class="li" updated="20230219121045"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-tixrpss" data-type="NodeParagraph" class="p" updated="20230219121045"><div contenteditable="true" spellcheck="false">由同步算法决定数据合并和覆盖，请参考下述工作原理介绍</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-vzxk1jz" data-type="NodeListItem" class="li" updated="20230219121049"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-1gxchhr" data-type="NodeParagraph" class="p" updated="20230219120922"><div contenteditable="true" spellcheck="false">手动同步</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-no67dio" data-type="NodeList" class="list" updated="20230219121049"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-5cx2eby" data-type="NodeListItem" class="li"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-1wfzyl4" data-type="NodeParagraph" class="p" updated="20230219120927"><div contenteditable="true" spellcheck="false">仅启动和退出时进行一次同步，使用中需要手动触发同步</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-gq4mmhp" data-type="NodeListItem" class="li" updated="20230219121049"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-zsvwvg9" data-type="NodeParagraph" class="p" updated="20230219121049"><div contenteditable="true" spellcheck="false">由同步算法决定数据合并和覆盖，请参考下述工作原理介绍</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-mzynq44" data-type="NodeListItem" class="li"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-zlxogea" data-type="NodeParagraph" class="p" updated="20230219120848"><div contenteditable="true" spellcheck="false">完全手动同步：启动和退出时均不同步，完全手动控制同步时机和同步方向</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="h2" data-node-id="20230808120347-lptnyvq" data-node-index="10" data-type="NodeHeading" class="h2" updated="20230219121525"><div contenteditable="true" spellcheck="false">自动/手动同步模式工作原理</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-node-id="20230808120347-o64blc2" data-node-index="11" data-type="NodeParagraph" class="p" updated="20220703225614"><div contenteditable="true" spellcheck="false"><span data-type="virtual-block-ref">思源</span>通过对比云端<span data-type="virtual-block-ref">数据快照</span>和本地<span data-type="virtual-block-ref">数据快照</span>进行相应操作：</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-j4bqb3a" data-node-index="12" data-type="NodeList" class="list" updated="20220703230810"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-7uvkzsb" data-type="NodeListItem" class="li" updated="20210901163356"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-dx8pr4f" data-type="NodeParagraph" class="p" updated="20220703230507"><div contenteditable="true" spellcheck="false">如果快照相同则忽略本次同步</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-pvyr15g" data-type="NodeListItem" class="li" updated="20220703230810"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-5e92ogb" data-type="NodeParagraph" class="p" updated="20220703230630"><div contenteditable="true" spellcheck="false">如果快照不同，则将本地距离上次同步的变更上传到云端，将云端最新的变更合并到本地</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-vb1ee0l" data-type="NodeList" class="list" updated="20220703230810"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-fbsghqb" data-type="NodeListItem" class="li"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-cvefpca" data-type="NodeParagraph" class="p" updated="20220703230650"><div contenteditable="true" spellcheck="false">如果两端的变更没有冲突则直接合并</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-7p8pzdq" data-type="NodeListItem" class="li" updated="20220703230810"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-t5n8fkj" data-type="NodeParagraph" class="p" updated="20220703230810"><div contenteditable="true" spellcheck="false">如果存在文件冲突，则以本地为准覆盖云端，同时拉取到的云端冲突文件会归入到<span data-type="virtual-block-ref">数据历史</span>中</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-node-id="20230808120347-piwm6s0" data-node-index="13" data-type="NodeParagraph" class="p" updated="20230219121719"><div contenteditable="true" spellcheck="false">自动同步时间间隔算法描述如下：</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="u" data-node-id="20230808120347-3afa1j8" data-node-index="14" data-type="NodeList" class="list" updated="20220510104801"><div data-marker="*" data-subtype="u" data-node-id="20230808120347-9gjv9e4" data-type="NodeListItem" class="li" updated="20220510104612"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-sx4xflq" data-type="NodeParagraph" class="p" updated="20220510104612"><div contenteditable="true" spellcheck="false">数据变动后 30 秒如果不再发生变动则进行一次对比，如果继续发生变动则顺延 30 秒</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="*" data-subtype="u" data-node-id="20230808120347-uu8mf5z" data-type="NodeListItem" class="li" updated="20220510104801"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20230808120347-tm5aosj" data-type="NodeParagraph" class="p" updated="20220510104801"><div contenteditable="true" spellcheck="false">没有数据变动则按 5 分钟、8 分钟、16 分钟、32 分钟……递增间隔</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="h2" data-node-id="20230808120347-w8dfrmf" data-node-index="15" data-type="NodeHeading" class="h2" updated="20230219120510"><div contenteditable="true" spellcheck="false">自动同步模式场景例举</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-node-id="20230808120347-92sa9pr" data-node-index="16" data-type="NodeParagraph" class="p" updated="20220307094844"><div contenteditable="true" spellcheck="false">从上述工作原理我们可以得知，<span data-type="virtual-block-ref">思源</span>仅支持在多设备上交替同步数据：设备 A 上同步完成以后设备 B 上再进行同步。无法支持多设备同时同步，这样会发生无法预期的数据覆盖。</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="h3" data-node-id="20230808120347-dec0dhv" data-node-index="17" data-type="NodeHeading" class="h3" updated="20220307092705"><div contenteditable="true" spellcheck="false">正常场景</div><div class="protyle-attr" contenteditable="false">​</div></div><div data-subtype="o" data-node-id="20230808120347-0t8dl3b" data-node-index="18" data-type="NodeList" class="list" updated="20220307093834"><div data-marker="1." data-subtype="o" data-node-id="20230808120347-hoyv0c6" data-type="NodeListItem" class="li"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">1.</div><div data-node-id="20230808120347-pnaqfwp" data-type="NodeParagraph" class="p" updated="20220307093526"><div contenteditable="true" spellcheck="false">在设备 A 上编辑后执行同步（通过自动或者手动触发同步），此时云端数据会被设备 A 数据覆盖，既云端和设备 A 保持数据一致</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="2." data-subtype="o" data-node-id="20230808120347-f6n68f0" data-type="NodeListItem" class="li"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">2.</div><div data-node-id="20230808120347-r17i3kh" data-type="NodeParagraph" class="p" updated="20220307093637"><div contenteditable="true" spellcheck="false">在设备 B 上执行同步，此时设备 B 数据会被云端数据覆盖，即云端和设备 A、B 保持数据一致</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="3." data-subtype="o" data-node-id="20230808120347-8r0pu6k" data-type="NodeListItem" class="li"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">3.</div><div data-node-id="20230808120347-cxnduxx" data-type="NodeParagraph" class="p" updated="20220307093705"><div contenteditable="true" spellcheck="false">设备 B 上编辑后再次执行同步，此时云端数据会被设备 B 数据覆盖，既云端和设备 B 保持数据一致</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div data-marker="4." data-subtype="o" data-node-id="20230808120347-x5cb7aq" data-type="NodeListItem" class="li" updated="20220307093834"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">4.</div><div data-node-id="20230808120347-099ii2x" data-type="NodeParagraph" class="p" updated="20220307093834"><div contenteditable="true" spellcheck="false">在设备 A 上执行同步，此时设备 A 数据会被云端数据覆盖，即云端和设备 A、B 保持数据一致</div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div><div class="protyle-attr" contenteditable="false">​</div></div>

    </div>
    <script src="../../../appearance/icons/material/icon.js?2.10.2"></script>
    <script src="../../../stage/build/export/protyle-method.js?2.10.2"></script>
    <script src="../../../stage/protyle/js/lute/lute.min.js?2.10.2"></script>
    <script>
        window.siyuan = {
          config: {
            appearance: { mode: 0, codeBlockThemeDark: "base16/dracula", codeBlockThemeLight: "github" },
            editor: {
              codeLineWrap: true,
              codeLigatures: false,
              plantUMLServePath: "https://www.plantuml.com/plantuml/svg/~1",
              codeSyntaxHighlightLineNum: true,
              katexMacros: JSON.stringify({}),
            }
          },
          languages: {copy:"复制"}
        };
        const previewElement = document.getElementById('preview');
        Protyle.highlightRender(previewElement, "stage/protyle");
        Protyle.mathRender(previewElement, "stage/protyle", false);
        Protyle.mermaidRender(previewElement, "stage/protyle");
        Protyle.flowchartRender(previewElement, "stage/protyle");
        Protyle.graphvizRender(previewElement, "stage/protyle");
        Protyle.chartRender(previewElement, "stage/protyle");
        Protyle.mindmapRender(previewElement, "stage/protyle");
        Protyle.abcRender(previewElement, "stage/protyle");
        Protyle.htmlRender(previewElement);
        Protyle.plantumlRender(previewElement, "stage/protyle");
        document.querySelectorAll(".protyle-action__copy").forEach((item) => {
          item.addEventListener("click", (event) => {
                navigator.clipboard.writeText(item.parentElement.nextElementSibling.textContent.trimEnd());
                event.preventDefault();
                event.stopPropagation();
          })
        });
    </script></body></html>